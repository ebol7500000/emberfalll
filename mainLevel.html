<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Lista de Itens Gamify</title>
    <link rel="icon" type="image/png" href="Gemini_Generated_Image_oza54roza54roza5.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* Cores base para o tema */
        :root {
            --bg-color: #121212; /* Fundo principal (preto) */
            --main-color: #1e1e1e; /* Fundo de se√ß√µes (cinza escuro) */
            --font-color: #e0e0e0; /* Cor da fonte (cinza claro) */
            --highlight-color: #d4a761; /* Cor de destaque (ouro envelhecido) */
            --highlight-gradient: linear-gradient(90deg, #d4a761, #ffcc77);
            --danger-color: #b73e3e; /* Cor para a√ß√µes de perigo (vermelho) */
            --button-color: #555555; /* Cor para bot√µes padr√£o (cinza) */
        }

        body {
            background-color: var(--bg-color);
            background-image: radial-gradient(circle, #2e2e2e 1px, #121212 1px);
            background-size: 20px 20px;
            font-family: 'Poppins', sans-serif;
            color: var(--font-color);
            text-align: center;
            padding-bottom: 20px;
        }

        h1 {
            font-family: 'Montserrat', sans-serif;
            color: var(--highlight-color);
            text-shadow: 0 0 10px rgba(212, 167, 97, 0.4);
            padding: 20px 0;
            border-bottom: 2px solid var(--highlight-color);
            display: inline-block;
            margin-top: 20px;
        }

        .scroll {
            background-color: var(--main-color);
            border: 2px solid #2e2e2e;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            height: 400px;
            margin: 20px auto;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.6);
        }
        
        .scroll::-webkit-scrollbar {
            width: 8px;
        }

        .scroll::-webkit-scrollbar-track {
            background: #333333;
            border-radius: 10px;
        }

        .scroll::-webkit-scrollbar-thumb {
            background: var(--highlight-color);
            border-radius: 10px;
        }

        .item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #2e2e2e;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            transition: background-color 0.3s, border-color 0.3s;
            border: 1px solid transparent;
        }
        
        .item:hover {
            background-color: #3e3e3e;
            border-color: var(--highlight-color);
        }

        .item img {
            width: 50px;
            height: 50px;
            margin-right: 15px;
            border-radius: 5px;
            object-fit: cover;
        }
        
        .item span {
            flex-grow: 1;
            text-align: left;
        }
        
        .item button {
            background-color: var(--danger-color);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 12px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 16px;
        }
        
        .item button:hover {
            background-color: #9c2a2a;
        }

        .crud {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        /* Cont√™iner para os bot√µes de backup */
        .backup-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        input, button, select {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #444;
            background-color: #222;
            color: var(--font-color);
            font-family: inherit;
            transition: background-color 0.3s, border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--highlight-color);
            background-color: #333;
        }

        .crud button {
            background-color: var(--button-color);
            border: none;
            cursor: pointer;
        }
        
        .crud button:hover {
            background-color: #666;
        }

        .backup-buttons button {
            background-color: var(--highlight-color);
            color: black;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .backup-buttons button:hover {
            background-color: #ffcc77;
        }
        
        input[type="file"]::file-selector-button {
            background-color: #444;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        input[type="file"]::file-selector-button:hover {
            background-color: #5a6268;
        }

        /* Barra de XP */
        .xp-container {
            width: 90%;
            max-width: 800px;
            margin: 20px auto;
            background-color: var(--main-color);
            border: 1px solid #444;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            overflow: hidden;
            height: 30px;
            position: relative;
        }
        .xp-bar {
            height: 100%;
            background: var(--highlight-gradient);
            width: 0%;
            transition: width 0.5s ease;
        }
        .xp-text {
            position: absolute;
            width: 100%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-size: 14px;
            color: #121212;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.4);
        }
        .level-display {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
            color: var(--highlight-color);
        }

        /* Controle de XP/Level */
        .xp-control {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 10px;
            display: inline-block;
            margin-top: 20px;
            border: 1px solid #444;
        }

        /* Anima√ß√£o de ganho de XP */
        .xp-gain {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: var(--highlight-color);
            font-weight: bold;
            animation: fadeUp 1.5s forwards;
            pointer-events: none;
            text-shadow: 1px 1px 5px rgba(255, 255, 255, 0.5);
        }
        @keyframes fadeUp {
            0% { opacity: 1; transform: translate(-50%, -50%); }
            100% { opacity: 0; transform: translate(-50%, -150%); }
        }

        /* Estilos para os menus colaps√°veis */
        .collapsible {
            background-color: var(--main-color);
            color: var(--font-color);
            cursor: pointer;
            padding: 18px;
            width: 90%;
            max-width: 800px;
            border: none;
            text-align: left;
            outline: none;
            font-size: 18px;
            font-weight: bold;
            margin: 10px auto 0;
            border-radius: 10px 10px 0 0;
            border: 1px solid #444;
            border-bottom: none;
            position: relative;
        }

        .collapsible:after {
            content: '\002B';
            color: var(--highlight-color);
            font-weight: bold;
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        .active:after {
            content: '\2212';
        }

        .content {
            width: 90%;
            max-width: 800px;
            margin: 0 auto 20px;
            padding: 0 18px;
            background-color: var(--main-color);
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
            border-radius: 0 0 10px 10px;
            border: 1px solid #444;
            border-top: none;
        }

        .section-container {
            margin-bottom: 30px;
        }
    </style>
</head>
<body>

    <h1>üìú Lista de Itens </h1>

    <div class="section-container">
        <!-- Menu 1: N√≠vel -->
        <button type="button" class="collapsible">N√≠vel (0 - MAX)</button>
        <div class="content">
            <div class="level-display">N√≠vel: <span id="playerLevel">1</span></div>
            <div class="xp-container">
                <div class="xp-bar" id="xpBar"></div>
                <div class="xp-text" id="xpText">0 / 300 XP</div>
            </div>

            <div class="xp-control">
                <label>XP:</label>
                <input type="number" id="xpInput" min="0" value="0">
                <label>Level:</label>
                <select id="levelInput"></select>
                <button onclick="applyManualChanges()">Aplicar</button>
            </div>
        </div>

        <!-- Menu 2: Modifier de Grinding -->
        <button type="button" class="collapsible">Modifier de Grinding</button>
        <div class="content">
            <div style="padding: 20px;">
                <p>Configura√ß√µes de grinding ser√£o adicionadas aqui.</p>
                <!-- Adicione aqui os controles para modificar o grinding -->
            </div>
        </div>

        <!-- Menu 3: Lista de Itens -->
        <button type="button" class="collapsible">Lista de Itens</button>
        <div class="content">
            <div class="scroll" id="itemList"></div>
        </div>

        <!-- Menu 4: Gerenciar (JSON import/export) -->
        <button type="button" class="collapsible">Gerenciar (JSON import e export)</button>
        <div class="content">
            <div class="backup-buttons" style="padding: 20px;">
                <button onclick="exportBackup()">Exportar Backup üíæ</button>
                <button onclick="document.getElementById('importInput').click()">Importar Backup üìÇ</button>
                <input type="file" id="importInput" accept=".json" style="display: none;">
            </div>
        </div>
    </div>

    <!-- Menu Adicionar Item (fixo na parte inferior) -->
    <div class="crud" style="width: 90%; max-width: 800px; margin: 20px auto; background-color: var(--main-color); padding: 20px; border-radius: 10px; border: 1px solid #444;">
        <h3 style="margin-top: 0; color: var(--highlight-color);">Adicionar Item</h3>
        <input type="text" id="itemName" placeholder="Nome do Item">
        <input type="number" id="itemValue" placeholder="Valor">
        <input type="file" id="itemImageInput" accept="image/*">
        <button onclick="addItem()">Adicionar</button>
    </div>

    <script>
        let items = JSON.parse(localStorage.getItem('mmorpgItems')) || [];

        const MAX_LEVEL = 99; // N√≠vel m√°ximo antes de come√ßar o Paragon

        let playerXP = parseInt(localStorage.getItem('playerXP')) || 0;
        let playerLevel = parseInt(localStorage.getItem('playerLevel')) || 1;
        let paragonLevel = parseInt(localStorage.getItem('paragonLevel')) || 0;
        let paragonPoints = parseInt(localStorage.getItem('paragonPoints')) || 0;

        // F√≥rmulas de XP baseadas em Diablo 2
        function getXPToNextLevel(level) {
            if (level >= MAX_LEVEL) {
                // L√≥gica Paragon (Diablo 3)
                return 25000 + (paragonLevel * 500);
            } else {
                // L√≥gica Diablo 2
                return Math.floor(Math.pow(level, 2) * 100 + level * 500 + 1000);
            }
        }

        // Preenche o select de levels at√© o n√≠vel m√°ximo
        const levelSelect = document.getElementById('levelInput');
        for (let lvl = 1; lvl <= MAX_LEVEL; lvl++) {
            let opt = document.createElement('option');
            opt.value = lvl;
            opt.textContent = lvl;
            levelSelect.appendChild(opt);
        }

        function renderItems() {
            const list = document.getElementById('itemList');
            list.innerHTML = '';
            items.forEach((item, index) => {
                list.innerHTML += `
                    <div class="item">
                        <img src="${item.image}" alt="${item.name}">
                        <span>${item.name}</span>
                        <span>${item.value}</span>
                        <button onclick="deleteItem(${index})">üóëÔ∏è</button>
                    </div>
                `;
            });
        }

        function addItem() {
            const name = document.getElementById('itemName').value;
            const value = document.getElementById('itemValue').value;
            const imageInput = document.getElementById('itemImageInput');
            const file = imageInput.files[0];

            if (name && value && file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const image = e.target.result;
                    items.push({ name, value, image });
                    localStorage.setItem('mmorpgItems', JSON.stringify(items));
                    renderItems();
                    document.getElementById('itemName').value = '';
                    document.getElementById('itemValue').value = '';
                    imageInput.value = '';
                };
                reader.readAsDataURL(file);
            }
        }

        function deleteItem(index) {
            if (confirm('Tem certeza que deseja deletar este item?')) {
                items.splice(index, 1);
                localStorage.setItem('mmorpgItems', JSON.stringify(items));
                renderItems();
                gainXP(100);
            }
        }

        function gainXP(amount) {
            playerXP += amount;
            showXPGain(amount);
            
            let xpToNext = getXPToNextLevel(playerLevel);

            if (playerLevel < MAX_LEVEL) {
                if (playerXP >= xpToNext) {
                    playerLevel++;
                    playerXP -= xpToNext;
                    alert(`üéâ Voc√™ subiu para o n√≠vel ${playerLevel}!`);
                }
            } else {
                // L√≥gica para n√≠veis Paragon
                if (playerXP >= xpToNext) {
                    paragonLevel++;
                    paragonPoints++;
                    playerXP -= xpToNext;
                    alert(`‚ú® Voc√™ subiu para o N√≠vel Paragon ${paragonLevel}! Voc√™ tem ${paragonPoints} ponto(s) para distribuir.`);
                }
            }

            saveProgress();
            updateXPBar();
        }

        function showXPGain(amount) {
            const xpElement = document.createElement('div');
            xpElement.className = 'xp-gain';
            xpElement.innerText = `+${amount} XP`;
            document.body.appendChild(xpElement);
            setTimeout(() => xpElement.remove(), 1500);
        }

        function updateXPBar() {
            let xpToNext = getXPToNextLevel(playerLevel);
            let currentXP = playerXP;

            if (playerLevel >= MAX_LEVEL) {
                // Se o jogador j√° est√° no n√≠vel m√°ximo, a barra de XP representa o progresso do n√≠vel Paragon
                xpToNext = getXPToNextLevel(MAX_LEVEL); // Paragon XP
                document.getElementById('playerLevel').innerText = `${MAX_LEVEL} (Paragon ${paragonLevel})`;
                
            } else {
                    document.getElementById('playerLevel').innerText = playerLevel;
            }

            const percent = (currentXP / xpToNext) * 100;
            document.getElementById('xpBar').style.width = percent + '%';
            
            let xpDisplayText = `${currentXP} / ${xpToNext} XP`;
            document.getElementById('xpText').innerText = xpDisplayText;
            
            // Atualiza inputs
            document.getElementById('xpInput').value = currentXP;
            document.getElementById('levelInput').value = playerLevel;
        }

        function saveProgress() {
            localStorage.setItem('playerXP', playerXP);
            localStorage.setItem('playerLevel', playerLevel);
            localStorage.setItem('paragonLevel', paragonLevel);
            localStorage.setItem('paragonPoints', paragonPoints);
            localStorage.setItem('mmorpgItems', JSON.stringify(items)); // Salvando os itens tamb√©m
        }

        // Aplicar mudan√ßas manuais
        function applyManualChanges() {
            let newXP = parseInt(document.getElementById('xpInput').value) || 0;
            let newLevel = parseInt(document.getElementById('levelInput').value) || 1;
            
            // Valida√ß√£o de inputs para evitar n√∫meros negativos
            newXP = Math.max(0, newXP);
            newLevel = Math.max(1, newLevel);

            if (newLevel <= MAX_LEVEL) {
                playerXP = newXP;
                playerLevel = newLevel;
                paragonLevel = 0;
                paragonPoints = 0;
            } else {
                alert(`N√≠vel m√°ximo √© ${MAX_LEVEL}. Para ir al√©m, use a l√≥gica de Paragon.`);
            }

            saveProgress();
            updateXPBar();
        }

        /* --- NOVAS FUN√á√ïES DE BACKUP --- */

        // Fun√ß√£o para exportar os dados como um arquivo JSON
        function exportBackup() {
            // Cria um objeto com todos os dados que voc√™ quer salvar
            const backupData = {
                items: items,
                playerXP: playerXP,
                playerLevel: playerLevel,
                paragonLevel: paragonLevel,
                paragonPoints: paragonPoints
            };
            
            // Converte o objeto para uma string JSON formatada
            const dataStr = JSON.stringify(backupData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            
            // Cria um link tempor√°rio para download
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'gamify-backup.json';
            
            // Simula o clique e remove o link
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert('Backup exportado com sucesso!');
        }

        // Lida com o evento de sele√ß√£o de arquivo
        document.getElementById('importInput').addEventListener('change', importBackup);

        // Fun√ß√£o para importar os dados a partir de um arquivo JSON
        function importBackup(event) {
            const file = event.target.files[0];
            if (!file) {
                return;
            }

            if (confirm('Importar um backup ir√° sobrescrever seus dados atuais. Deseja continuar?')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        // Faz o parsing do JSON do arquivo
                        const importedData = JSON.parse(e.target.result);
                        
                        // Atualiza as vari√°veis do jogo com os dados importados
                        items = importedData.items || [];
                        playerXP = importedData.playerXP || 0;
                        playerLevel = importedData.playerLevel || 1;
                        paragonLevel = importedData.paragonLevel || 0;
                        paragonPoints = importedData.paragonPoints || 0;
                        
                        // Salva os novos dados no localStorage e renderiza a tela
                        saveProgress();
                        renderItems();
                        updateXPBar();
                        alert('Backup importado com sucesso!');
                    } catch (error) {
                        alert('Erro ao importar o arquivo. Verifique se √© um arquivo JSON v√°lido.');
                        console.error('Erro ao fazer o parsing do JSON:', error);
                    }
                };
                reader.readAsText(file);
            }
            
            // Limpa o input de arquivo para permitir a importa√ß√£o do mesmo arquivo novamente
            event.target.value = '';
        }
        
        // Garante que o select de n√≠vel esteja atualizado com o valor salvo
        levelSelect.value = playerLevel;

        // Adiciona funcionalidade aos menus colaps√°veis
        var coll = document.getElementsByClassName("collapsible");
        for (var i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.maxHeight){
                    content.style.maxHeight = null;
                } else {
                    content.style.maxHeight = content.scrollHeight + "px";
                } 
            });
        }

        // Abre o primeiro menu por padr√£o
        document.getElementsByClassName("collapsible")[0].click();

        renderItems();
        updateXPBar();
    </script>
</body>
</html>